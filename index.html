<!DOCTYPE html>
<html lang="en">
    <head>
        <!-- Required meta tags -->
        <meta charset="utf-8"/>
        <meta name="viewport" content="width=device-width, initial-scale=1"/>
        <!-- Bootstrap CSS -->
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous"/>
        <!-- Bootstrap Icons -->
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.1/font/bootstrap-icons.css"/>
        <!-- jQuery 3.6 -->
        <script src="https://code.jquery.com/jquery-3.6.0.min.js"
            integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4="
            crossorigin="anonymous"></script>
        <!-- AngularJS CDN -->
        <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.8.2/angular.min.js"/> 
        <link rel="stylesheet" href="/src/territoryApp.css"/>
        <title>Territory Manager</title>        
    </head>
    <body id="ngApp" ng-app="terrApp" ng-controller="terrCon">
<!--
 /$$   /$$  /$$$$$$  /$$    /$$ /$$$$$$$   /$$$$$$  /$$$$$$$
| $$$ | $$ /$$__  $$| $$   | $$| $$__  $$ /$$__  $$| $$__  $$
| $$$$| $$| $$  \ $$| $$   | $$| $$  \ $$| $$  \ $$| $$  \ $$
| $$ $$ $$| $$$$$$$$|  $$ / $$/| $$$$$$$ | $$$$$$$$| $$$$$$$/
| $$  $$$$| $$__  $$ \  $$ $$/ | $$__  $$| $$__  $$| $$__  $$
| $$\  $$$| $$  | $$  \  $$$/  | $$  \ $$| $$  | $$| $$  \ $$
| $$ \  $$| $$  | $$   \  $/   | $$$$$$$/| $$  | $$| $$  | $$
|__/  \__/|__/  |__/    \_/    |_______/ |__/  |__/|__/  |__/
-->
        <nav class="navbar navbar-expand-lg navbar-light">
            <div class="container">
                <a class="navbar-brand" href="#">
                    <i class="bi bi-map-fill" style="color: #1869a3;"></i> <span id="territoryNumber">Territory Manager</span>
                </a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="d-flex"> 
                    <div class="collapse navbar-collapse" id="navbarSupportedContent">                        
                        <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                            <li id="user_menu" class="nav-item dropdown" style="display: none;">
                                <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                                    {{userProfile.name}}
                                </a>
                                <ul class="dropdown-menu">
                                    <li><a class="dropdown-item" href="#" ng-click="showCallOrderPanel=!showCallOrderPanel">Toggle Call Order</a></li>
                                    <li><h6 class="dropdown-header">Layouts</h6></li>
                                    <li><a class="dropdown-item" href="#" ng-click="showCard=true;showList=false;changeLayout()">Simple</a></li>
                                    <li><a class="dropdown-item" href="#" ng-click="showCard=false;showList=true;changeLayout()">List</a></li>
                                    <li><a class="dropdown-item" href="#" ng-click="showCard=true;showList=true;changeLayout()">Full</a></li>
                                    <li><hr class="dropdown-divider"/></li>
                                    <li>                                            
                                        <button id="signout_button" class="dropdown-item btn btn-link">Sign Out</button>
                                    </li>
                                </ul>
                            </li>
                            <li class="nav-item">
                                <button id="authorize_button" class="dropdown-item btn btn-link pe-2" style="display: none;">Sign in</button>
                            </li>
                        </ul>
                        <img src="{{userProfile.pictureUrl}}" class="rounded-circle" style="width:40px"  alt="..."/>
                    </div>
                </div>
            </div>
        </nav>
        <div id="contentAreaLoggedIn" class="container">
            <div class="row">
<!--
  /$$$$$$   /$$$$$$  /$$       /$$              /$$$$$$  /$$$$$$$  /$$$$$$$  /$$$$$$$$ /$$$$$$$
 /$$__  $$ /$$__  $$| $$      | $$             /$$__  $$| $$__  $$| $$__  $$| $$_____/| $$__  $$
| $$  \__/| $$  \ $$| $$      | $$            | $$  \ $$| $$  \ $$| $$  \ $$| $$      | $$  \ $$
| $$      | $$$$$$$$| $$      | $$            | $$  | $$| $$$$$$$/| $$  | $$| $$$$$   | $$$$$$$/
| $$      | $$__  $$| $$      | $$            | $$  | $$| $$__  $$| $$  | $$| $$__/   | $$__  $$
| $$    $$| $$  | $$| $$      | $$            | $$  | $$| $$  \ $$| $$  | $$| $$      | $$  \ $$
|  $$$$$$/| $$  | $$| $$$$$$$$| $$$$$$$$      |  $$$$$$/| $$  | $$| $$$$$$$/| $$$$$$$$| $$  | $$
 \______/ |__/  |__/|________/|________/       \______/ |__/  |__/|_______/ |________/|__/  |__/
-->
                <div id="callOrderPanel" class="col-xs-12 col-md-2 g-2" ng-show="showCallOrderPanel">
<!-- PLACEHOLDER -->
                    <span  ng-show="showCallOrderPlaceholders">
                        <h3>Call Order</h3>
                        <div class="btn-group-vertical d-grid mx-auto placeholder-glow">
                            <a href="#" tabindex="-1" class="btn btn-outline-secondary disabled placeholder col-6">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</a>
                            <a href="#" tabindex="-1" class="btn btn-outline-secondary disabled placeholder col-6">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</a>
                            <a href="#" tabindex="-1" class="btn btn-outline-secondary disabled placeholder col-6">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</a>
                        </div>
                    </span>
                    <span ng-show="!showCallOrderPlaceholders">
<!-- VIEW -->
                        <span ng-show="!showEditCallList">
                            <h3>Call Order <small><i class="bi bi-pencil" style="font-size: 1rem;" ng-click="showEditCallList=!showEditCallList"></i></small></h3>
                            <div class="btn-group-vertical d-grid mx-auto" role="group" aria-label="Basic radio toggle button group">
                                <input 
                                    ng-repeat-start="caller in callerList track by $index" 
                                    type="radio" 
                                    class="btn-check" 
                                    name="btnradio" 
                                    id="btnradio{{caller.id}}" 
                                    autocomplete="off" 
                                    ng-model="currentCaller.name" 
                                    ng-change="clickRow('next')"
                                    value="{{caller.name}}"/>
                                <label ng-repeat-end="true" class="btn btn-outline-secondary  mx-auto" for="btnradio{{caller.id}}">{{caller.name}}</label>
                            </div>
                        </span>
<!-- EDIT -->
                        <span ng-show="showEditCallList">
                            <h3>Call Order</h3>
                            <p>
                                Type the name of each caller on a seperate line. Use the controls to reorder them if necessary. 
                            </p>
                            <textarea class="form-control" rows="10" ng-model="callerNameList"/>
                            <div class="dropdown">
                                <button class="btn btn-outline-secondary dropdown-toggle" type="button" id="dropdownMenuButton1" data-bs-toggle="dropdown" aria-expanded="false">
                                    Reorder
                                </button>
                                <ul class="dropdown-menu" aria-labelledby="dropdownMenuButton1">
                                    <li><a class="dropdown-item" href="#" ng-click="reorderCallers(0)">Alphabetical</a></li>
                                    <li><a class="dropdown-item" href="#" ng-click="reorderCallers(1)">Reverse alphabetical</a></li>
                                    <li><a class="dropdown-item" href="#" ng-click="reorderCallers(2)">Random</a></li>
                                </ul>
                            </div>
                            <button class="btn btn-outline-secondary mt-2" type="button" ng-click="saveCallOrder()">Done</button>
                        </span>
                    </span>
                </div>
                <div class="col">
<!--   
    /$$$$$$   /$$$$$$  /$$       /$$             /$$$$$$ /$$   /$$ /$$$$$$$$ /$$$$$$
  /$$__  $$ /$$__  $$| $$      | $$            |_  $$_/| $$$ | $$| $$_____//$$__  $$
 | $$  \__/| $$  \ $$| $$      | $$              | $$  | $$$$| $$| $$     | $$  \ $$
 | $$      | $$$$$$$$| $$      | $$              | $$  | $$ $$ $$| $$$$$  | $$  | $$
 | $$      | $$__  $$| $$      | $$              | $$  | $$  $$$$| $$__/  | $$  | $$
 | $$    $$| $$  | $$| $$      | $$              | $$  | $$\  $$$| $$     | $$  | $$
 |  $$$$$$/| $$  | $$| $$$$$$$$| $$$$$$$$       /$$$$$$| $$ \  $$| $$     |  $$$$$$/
  \______/ |__/  |__/|________/|________/      |______/|__/  \__/|__/      \______/
-->
                    <div id="callInfoPanel" ng-show="showCard">
<!-- BLUE BANNER -->
                        <div class="bg-info d-flex align-items-center p-2 rounded-3">
                            <div class="me-auto">
                                <h4><span ng-show="showCallOrderPanel">{{currentCaller.name}} </span>Calling...</h4>
                                <div class="btn-group pe-2" role="group" aria-label="Basic outlined example">
                                    <div class="btn btn-light btn-sm" ng-click="clickRow('prev')"><i class="bi bi-chevron-up"></i></div>                                                                    
                                    <div class="btn btn-light btn-sm" ng-click="clickRow('next')"><i class="bi bi-chevron-down"></i></div>
                                </div>
                            </div>
                            <p class="placeholder-glow text-center flex-grow-1  display-4" ng-show="showPlaceholders">
                                (<span class="placeholder" style="width:100px"></span>) <span class="placeholder display-4" style="width:100px"></span>-<span class="placeholder display-4" style="width:130px"></span>
                            </p>
                            <span class="d-none d-xl-block selectedPhone p-2 display-4 text-center flex-grow-1" ng-show="!showPlaceholders">{{selectedHouseholder.phone}}</span>
                            <span class="d-xl-none selectedPhone p-2 text-center flex-grow-1" ng-show="!showPlaceholders">{{selectedHouseholder.phone}}</span>
                        </div>
                        <div class="row ps-2 pe-2">
<!-- HOUSEHOLDER INFO -->
                            <div class="col-xs-12 col-lg-6">
                                <p class="placeholder-glow" ng-show="showPlaceholders">
                                    <h3 class="placeholder border-bottom" style="width:500px" ng-show="showPlaceholders"></h3>
                                    <h4 class="placeholder" style="width:500px" ng-show="showPlaceholders"></h4>
                                </p>
                                <h3 id="selectedName" class="border-bottom" ng-show="!showPlaceholders">{{selectedHouseholder.name}}</h3>
                                <h4 id="selectedAddress" ng-show="!showPlaceholders">{{selectedHouseholder.address}}</h4>
                            </div>
<!-- HISTORY-->
                            <div class="col">
                                <h3 class="border-bottom">History</h3>
<!-- PLACEHOLDER -->
                                <table class="table table-borderless table-sm" ng-show="showPlaceholders">
                                    <tr>
                                        <td><span class="placeholder" style="width:100px"></span></td>
                                        <td><span class="placeholder" style="width:100px"></span></td>
                                        <td><span class="placeholder" style="width:100px"></span></td>
                                    </tr>
                                    <tr>
                                        <td><span class="placeholder" style="width:100px"></span></td>
                                        <td><span class="placeholder" style="width:100px"></span></td>
                                        <td><span class="placeholder" style="width:100px"></span></td>
                                    </tr>
                                    <tr>
                                        <td><span class="placeholder" style="width:100px"></span></td>
                                        <td><span class="placeholder" style="width:100px"></span></td>
                                        <td><span class="placeholder" style="width:100px"></span></td>
                                    </tr>
                                </table>
<!-- VIEW -->
                                <table class="table table-borderless table-sm" ng-show="!showPlaceholders">
                                    <tr ng-repeat="note in selectedHouseholderNotes">
                                        <td>{{note.date}}</td>
                                        <td>{{note.response}}</td>
                                        <td>{{note.note}}</td>
                                    </tr>
<!-- NEW NOTE FORM -->
                                    <tr>
                                        <td>{{newNote.date}}</td>
                                        <td>
                                            <select class="form-select" ng-model="newNote.response" ng-options="x for x in responses">
                                            </select>
                                        </td>
                                        <td>
                                            <div class="input-group">
                                                <input type="text" class="form-control" ng-model="newNote.note" aria-label="Recipient's username" aria-describedby="button-addon2"/>
                                                <button class="btn btn-outline-secondary" type="button" id="button-addon2" ng-click="updateNotes()">Add</button>
                                            </div>
                                        </td>
                                    </tr>
                                </table>
                            </div>
                        </div>
                    </div>
<!--
 /$$$$$$$$ /$$$$$$  /$$$$$$$  /$$       /$$$$$$$$
|__  $$__//$$__  $$| $$__  $$| $$      | $$_____/
   | $$  | $$  \ $$| $$  \ $$| $$      | $$
   | $$  | $$$$$$$$| $$$$$$$ | $$      | $$$$$
   | $$  | $$__  $$| $$__  $$| $$      | $$__/
   | $$  | $$  | $$| $$  \ $$| $$      | $$
   | $$  | $$  | $$| $$$$$$$/| $$$$$$$$| $$$$$$$$
   |__/  |__/  |__/|_______/ |________/|________/
-->
                    <div class="tableFixHead table-responsive rounded-3">
                        <table id="addressTable" class="table align-top table-hover" ng-show="showList">
                            <thead class="table-info">
                                <th ng-repeat="th in tableHeaders track by $index">{{th}}</th>
                            </thead>
                            <tr id="housholderTR-{{$index}}" class="hh-row" ng-repeat="hh in housholderList track by $index" ng-class="tableRowClass($index)" ng-click="selectHouseholder($index)">
                                <td>{{hh.rowNumber}}</td>
                                <td>{{hh.name}}</td>
                                <td>{{hh.address}}</td>
                                <td>{{hh.phone}}</td>
                                <td>{{hh.notes}}</td>
                            </tr>
                        </table>
                    </div>
                    <input id="territoryCallComplete" type="text" ng-model="apiStatus" style="display:none"/>
                </div>                    
            </div>                
        </div>
        <script type="text/javascript" src="src/territoryapp.js"></script>
        <script async="true" defer="true" src="https://apis.google.com/js/api.js"
            onload="this.onload=function(){};handleClientLoad()"
            onreadystatechange="if (this.readyState === 'complete') this.onload()">
        </script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
    </body>
</html>